<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/">
<head th:replace="fragments :: head"></head>

<body>
<nav th:replace="fragments :: nav"></nav>

<header >
</header>

<div class="cprofile row p-4 m-auto position-relative ">
  <div class="col-sm d-flex-row m-auto p-2">
    <p class="clinicLabel">Clinic Name</p>
    <h2 class="display-5" th:text="${clinic.name}"></h2>
    <p class="clinicLabel">Address</p>
      <div>
        <p class="mb-1 fs-6" th:text="${clinic.address}"></p>
        <p class="fs-6" th:text="${clinic.city} + ', ' + ${clinic.state} + ' ' + ${clinic.zip}"></p>
      </div>
    <p class="clinicLabel">Phone Number</p>
    <p class="fs-6" th:text="${clinic.phoneNumberToString()}"></p>
    <p class="clinicLabel">Website</p>
    <a th:href="@{${clinic.website}}">
      <p class="fs-6" th:text="${clinic.website}"></p>
    </a>
  </div>
  <div class="col-sm">
    <div>
      <a th:href="@{'https://maps.google.com/?q=' + ' ' + ${clinic.address} + ' ' + ${clinic.city} + ' ' + ${clinic.state} + ' ' + ${clinic.zip}}">
        <img th:src="@{'https://maps.googleapis.com/maps/api/staticmap?center=' + ${clinic.address} + ${clinic.city} + ${clinic.state} + ${clinic.zip} + '&markers=' + ${clinic.address} + ${clinic.city} + ${clinic.state} + ${clinic.zip} + '&zoom=12&size=400x400&key=AIzaSyCjFOLSO6Os1tn4eSNktZ_tyKEm6yWUHh4'}">
      </a>
    </div>
  </div>

  <section >
    <div class="d-flex align-items-center mt-2 py-1">
      <h3 class="mb-0">Reviews</h3>
      <div th:if="${!(average == null)}"class="mx-2 d-flex align-items-stretch">
        <label class="fa fa-star fa-2x checked" ></label>
        <label class="fa fa-star fa-2x" th:classappend="${average} >= 2 ? 'checked' : ''"></label>
        <label class="fa fa-star fa-2x" th:classappend="${average} >= 3 ? 'checked' : ''"></label>
        <label class="fa fa-star fa-2x" th:classappend="${average} >= 4 ? 'checked' : ''"></label>
        <label class="fa fa-star fa-2x" th:classappend="${average} >= 5 ? 'checked' : ''"></label>
      </div>
      <div class="mx-2" th:text="${!(average == null)} ? '(' + ${average} + ') from ' + ${totalReviews} + ' review(s)' : ''"></div>
    </div>
    <div th:if="${!session.isEmpty()} and ${!(review == null)}"><div th:replace="fragments :: add-review"></div></div>
    <div  class="fst-italic" th:text="${clinic.getReviews().isEmpty()} ? 'No Reviews Yet' : ''"></div>

    <div class="d-flex justify-content-start mt-3 text-start" th:each="review : ${clinic.getReviews()}">
      <section class="d-flex justify-content-start flex-column py-2">
        <p class="mb-0 fw-bold " th:text="${review.user.firstName}"></p>
        <div class="d-flex justify-content-start align-items-center ">
          <label class="fa fa-star checked" ></label>
          <label class="fa fa-star" th:classappend="${review.reviewRating} >= 2 ? 'checked' : ''"></label>
          <label class="fa fa-star" th:classappend="${review.reviewRating} >= 3 ? 'checked' : ''"></label>
          <label class="fa fa-star" th:classappend="${review.reviewRating} >= 4 ? 'checked' : ''"></label>
          <label class="fa fa-star" th:classappend="${review.reviewRating} >= 5 ? 'checked' : ''"></label>
          <p class="mb-0 mx-1" th:text="${#dates.format(review.createdTimestamp, 'MMMM dd, yyyy')}"></p>
        </div>
        <div class="font-italic" th:if=${!review.reviewText.isEmpty()} th:text="${'&quot' + review.reviewText + '&quot'}"></div>
      </section>
    </div>
</section>

</div>
</body>
</html>
